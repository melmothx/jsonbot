#!/usr/bin/env python
#
#

## bootstrap

import warnings
warnings.simplefilter("ignore")

import os, sys
sys.path.insert(0, os.getcwd())

from gozerlib.utils.generic import getversion
print getversion('FLEET')

## gozerlib imports

from gozerlib.datadir import makedirs
from gozerlib.boot import boot
from gozerlib.utils.log import setloglevel
from gozerlib.fleet import fleet
from gozerlib.utils.mainloop import mainloop
from gozerlib.utils.opts import makeopts, makeconfig
import gozerlib

## basic imports

import logging
import time

## options parser

opts = makeopts()

if opts.loglevel:
    setloglevel(opts.loglevel)
else:
    setloglevel("warning")

if opts.all:
    print "available fleet bots: %s" % fleet.avail()
    os._exit(0)

makedirs()
boot()

fleet.loadall(opts.args)

if opts.doresume:
    fleet.resume(opts.doresume)
    os.unlink(opts.doresume) # bye

fleet.startall()
mainloop()
